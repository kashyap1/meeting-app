(this["webpackJsonpcalendar-app"]=this["webpackJsonpcalendar-app"]||[]).push([[0],{11:function(e,t,a){e.exports={header:"Header_header__3pIG3",nav:"Header_nav__3g80T",nav__wrapper:"Header_nav__wrapper__GmS6D"}},12:function(e,t,a){e.exports={modal:"Modal_modal__3SD--",modal__fade:"Modal_modal__fade__3U4qw","fade-in":"Modal_fade-in__-cLvS",modal__overlay:"Modal_modal__overlay__M4MS-",modal__close:"Modal_modal__close__3R_4_",modal__body:"Modal_modal__body__2HiTA"}},16:function(e,t,a){e.exports={main:"Layout_main__sqD6j",layout:"Layout_layout__11vjy"}},21:function(e,t,a){e.exports={footer:"Footer_footer__wyghR"}},3:function(e,t,a){e.exports={form:"Meeting_form__3AMSV",meeting:"Meeting_meeting__2K2du",row__subFields:"Meeting_row__subFields__7MvI6",row:"Meeting_row__1yZxK",input:"Meeting_input__3yzOI",button__primary:"Meeting_button__primary__1-9JO",error:"Meeting_error__3qELt"}},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(10),s=a.n(c),r=a(8),l=a(4),o=a(13),i=a(22),d=a(20);var _={BASE_URL:"http://localhost:8000/",actionTypes:{USER_LOGGEDIN:"USER_LOGGEDIN",USER_LOGGEDOUT:"USER_LOGGEDOUT",MEETING_LOADED:"MEETING_LOADED",MEETING_SAVE:"MEETING_SAVE",MEETINGS_LOADED:"MEETINGS_LOADED"},DAYS:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],MONTHS:["Jan","Feb","Mar","Apr","May","June","Jul","Aug","Sep","Oct","Nov","Dec"]},u={user:{isLoggedIn:!1},meeting:[]};var j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,t=arguments.length>1?arguments[1]:void 0;return t.type===_.actionTypes.MEETINGS_LOADED?{...e.meeting,...t.payload}:e},m=Object(o.b)({user:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,{type:t,payload:a}=arguments.length>1?arguments[1]:void 0;const{USER_LOGGEDIN:n,USER_LOGGEDOUT:c}=_.actionTypes;switch(t){case n:return{...e.user,isLoggedIn:!0,id:a.id,userName:a.userName};case c:return{...e.user,isLoggedIn:!1,userName:null,id:null};default:return e}},meeting:j,router:d.routerReducer}),p=a(21),b=a.n(p),h=a(1);var O=function(){return Object(h.jsx)("footer",{className:b.a.footer,children:"Copyright \xa92021 Calendar"})},v=a(11),f=a.n(v);function x(){return document.cookie.split(";").reduce(((e,t)=>{const[a,n]=t.split("=");return e[a.trim()]=n.trim(),e}),{})}function g(e){Object.entries(x()).filter((t=>e.includes(t[0].trim()))).forEach((e=>{document.cookie="".concat(e[0],"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;")}))}var N=function(){const e=Object(l.b)(),t=Object(l.c)((e=>{let{user:t}=e;return t.isLoggedIn}))?Object(h.jsxs)("div",{className:f.a.nav__wrapper,children:[Object(h.jsx)(r.b,{to:"/",className:f.a.nav,children:"Calendar"}),Object(h.jsx)(r.b,{to:"/meeting",className:f.a.nav,children:"Schedule Meeting"}),Object(h.jsx)("a",{href:"/",onClick:t=>{t.preventDefault(),g(["id","userName"]),e({type:_.actionTypes.USER_LOGGEDOUT})},className:f.a.nav,children:"Sign Out"})]}):null;return Object(h.jsxs)("header",{className:f.a.header,children:[Object(h.jsx)("div",{children:"Calendar App"}),t]})},y=a(16),I=a.n(y);var E=function(e){let{children:t}=e;return Object(h.jsxs)("main",{className:I.a.main,children:[Object(h.jsx)(N,{}),Object(h.jsx)("section",{className:I.a.layout,children:t}),Object(h.jsx)(O,{})]})},w=a(2);function S(e){let{children:t}=e;const a=Object(l.b)(),n=Object(l.c)((e=>e.user));let c,s;return n.id||(({id:s,userName:c}=x()),s&&a({type:_.actionTypes.USER_LOGGEDIN,payload:{id:s,userName:c}})),n.id||s?t:Object(h.jsx)(w.a,{to:{pathname:"/login"}})}const D=e=>{if(!/^\d{1,2}-\d{1,2}-\d{4}$/.test(e))return!1;const t=e.split("-"),a=parseInt(t[0],10),n=parseInt(t[1],10),c=parseInt(t[2],10);if(c<1e3||c>3e3||0===parseInt(n,10)||parseInt(n,10)>12)return!1;const s=[31,28,31,30,31,30,31,31,30,31,30,31];return(c%400===0||c%100!==0&&c%4===0)&&(s[1]=29),a>0&&a<=s[n-1]};function T(e,t){const[a,n,c]=e.split("-"),[s,r,l]=t.split("-"),o=parseInt(c,10)===parseInt(l,10),i=parseInt(n,10)===parseInt(r,10);return!(parseInt(c,10)>parseInt(l,10)||o&&parseInt(n,10)>parseInt(r,10)||o&&i&&parseInt(a,10)>parseInt(s,10))}function M(e){const t={};if(e.name||(t.name="Name is required."),e.from&&e.to){const a=(new Date).toISOString().split("T")[0].split("-");D(e.from)&&D(e.to)?T("".concat(a[2],"-").concat(a[1],"-").concat(a[0]),e.from)?T(e.from,e.to)||(t.dates="From must be less then To date."):t.dates="Meeting date can not be in past.":t.dates="Valid From and To are required."}else t.from="From and To fields are required.";if(e.attendees){e.attendees.split(",").reduce(((e,t)=>((e=>String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/))(t)||e.push(t),e)),[]).length&&(t.attendees="Valid Attendees email is required.")}else t.attendees="Attendees are required.";return t}var L=a(7),C=a.n(L);var G=function(){const e=Object(l.b)(),t=Object(w.g)(),[a,c]=Object(n.useState)({userName:"",password:""}),[s,r]=Object(n.useState)({});Object(n.useEffect)((()=>{g(["id","userName"])}),[]);const o=e=>{const t={...a,[e.target.name]:e.target.value};return c(t),!1};return Object(h.jsx)("div",{className:C.a.login,children:Object(h.jsxs)("form",{className:C.a.form,children:[Object(h.jsx)("h2",{children:"Login Here"}),Object(h.jsxs)("div",{className:C.a.row,children:[Object(h.jsx)("input",{className:C.a.input,type:"text",name:"userName",value:a.userName,placeholder:"User Name",onChange:o}),Object(h.jsx)("div",{className:C.a.error,children:null===s||void 0===s?void 0:s.userName})]}),Object(h.jsxs)("div",{className:C.a.row,children:[Object(h.jsx)("input",{className:C.a.input,type:"password",name:"password",value:a.password,placeholder:"Password",onChange:o}),Object(h.jsx)("div",{className:C.a.error,children:null===s||void 0===s?void 0:s.password})]}),Object(h.jsx)("div",{className:C.a.row,children:Object(h.jsx)("input",{type:"submit",value:"Login",className:C.a.button__primary,onClick:async n=>{n.preventDefault();const c=function(e){const t={};return e.userName||(t.userName="User Name is required."),e.password||(t.password="Password is required."),t}(a);if(r(c),Object.keys(c).length)return null;const s=await fetch("".concat(_.BASE_URL,"users?userName=").concat(a.userName)).then((e=>e.json())),{id:l,userName:o,password:i}=(null===s||void 0===s?void 0:s[0])||{};return i===a.password&&(!function(e){const t=e.reduce(((e,t)=>{let{key:a,val:n}=t;return e.push("".concat(a,"=").concat(n,";")),e}),[]),a=new Date;a.setTime(a.getTime()+72e5);const n="expires=".concat(+a.toUTCString());t.forEach((e=>{document.cookie="".concat(e,";").concat(n,";path=/")}))}([{key:"id",val:l},{key:"userName",val:o}]),e({type:_.actionTypes.USER_LOGGEDIN,payload:{id:l,userName:o}}),t("/")),null}})})]})})},A=a(12),U=a.n(A);const k=document.getElementById("modal-root");function R(e,t){let{children:a,fade:s=!1,defaultOpened:r=!1}=e;const[l,o]=Object(n.useState)(r),i=Object(n.useCallback)((()=>o(!1)),[]);Object(n.useImperativeHandle)(t,(()=>({open:()=>o(!0),close:i})),[i]);const d=Object(n.useCallback)((e=>{27===e.keyCode&&i()}),[i]);return Object(n.useEffect)((()=>(l&&document.addEventListener("keydown",d,!1),()=>{document.removeEventListener("keydown",d,!1)})),[d,l]),Object(c.createPortal)(l?Object(h.jsxs)("div",{className:"".concat(U.a.modal," ").concat(s?U.a.modal__fade:""),children:[Object(h.jsx)("div",{className:U.a.modal__overlay,onClick:i,role:"presentation"}),Object(h.jsx)("span",{role:"button",className:U.a.modal__close,"aria-label":"close",onClick:i,tabIndex:0,children:"x"}),Object(h.jsx)("div",{className:U.a.modal__body,children:a})]}):null,k)}var F=Object(n.forwardRef)(R),q=a(6),Y=a.n(q);function J(e){const t=Object(n.useRef)(null),{date:a,meeting:c,cellInd:s}=e,r=Object(w.g)(),[l,o]=a.split("-"),i=parseInt(l,10),d=parseInt(o,10),u=c[a],{name:j,desc:m,attendees:p,dates:b}=u||{},O=u?Y.a["calendar__cell--highlighted"]:"",v=[0,6].includes(s)?Y.a.calendar__highlighted:"",f=1===i?"".concat(_.MONTHS[d-1]," "):"",x=(new Date).getMonth()+1!==d?Y.a["calendar__cell--disabled"]:"",g=u?Object(h.jsx)(F,{ref:t,children:Object(h.jsxs)("ul",{className:Y.a.Information,children:[Object(h.jsxs)("li",{className:Y.a.Information__container,children:[Object(h.jsx)("div",{className:Y.a.Information__label,children:"Name:"}),Object(h.jsx)("div",{children:j})]}),Object(h.jsxs)("li",{className:Y.a.Information__container,children:[Object(h.jsx)("div",{className:Y.a.Information__label,children:"Description:"}),Object(h.jsx)("div",{children:m})]}),Object(h.jsxs)("li",{className:Y.a.Information__container,children:[Object(h.jsx)("div",{className:Y.a.Information__label,children:"From - To:"}),Object(h.jsx)("div",{children:null===b||void 0===b?void 0:b.replace(","," - ")})]}),Object(h.jsxs)("li",{className:Y.a.Information__container,children:[Object(h.jsx)("div",{className:Y.a.Information__label,children:"Attendees:"}),Object(h.jsx)("div",{children:p})]})]})}):null;return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsxs)("div",{role:"presentation",className:"".concat(Y.a.calendar__cell," ").concat(O," ").concat(v," ").concat(x),onClick:e=>{let n=!1;2===e.detail&&(n=!0,(()=>{const e=c[a];!(!e||x)&&r("/meeting/".concat(e.id))})()),setTimeout((()=>{1!==e.detail||n||(()=>{var e;!!u&&(null===t||void 0===t||null===(e=t.current)||void 0===e||e.open())})()}),300)},children:[f,i]},a),g]})}const H=new Date,z=e=>{const t=e.toISOString().split("T")[0].split("-");return"".concat(t[2],"-").concat(t[1],"-").concat(t[0])};function B(e){return e.reduce(((e,t)=>{if(t.dates){const[a,n]=t.dates.split(",");if(a===n)e[a]=t;else{const c=function(e,t){const a=[e],[n,c,s]=e.split("-"),r=new Date("".concat(s,"-").concat(c,"-").concat(n));let l=0,o=e;for(;l<46&&o!==t;){r.setDate(r.getDate()+1),l+=1;const[e,t,n]=r.toISOString().split("T")[0].split("-");o="".concat(n,"-").concat(t,"-").concat(e),a.push(o)}return a}(a,n);e=c.reduce(((e,a)=>(e[a]=t,e)),e)}}return e}),{})}var P=a(9),V=a.n(P);const Z=function(){const e=[],t=(()=>{H.setDate(1);const e=H.getDay();H.setDate(1-e);const t=[z(H)];for(let a=1;a<42;a+=1)H.setDate(H.getDate()+1),t.push(z(H));return t})();let a=0,n=7;for(;n<=t.length;)e.push(t.slice(a,n)),a=n,n+=7;return e}();function K(){const e=Object(l.b)(),t=_.DAYS.map((e=>Object(h.jsx)("div",{className:V.a.calendar__cell,children:e},e))),{meetings:a,loggedInUser:c}=Object(l.c)((e=>{const t=Object.values(e.meeting);return{meetings:t.length?B(t):[],loggedInUser:e.user.id}}));Object(n.useEffect)((async()=>{const t=await fetch("".concat(_.BASE_URL,"meetings?userId=").concat(c)).then((e=>e.json()));e({type:_.actionTypes.MEETINGS_LOADED,payload:t})}),[]);const s=Z.map((e=>Object(h.jsx)("div",{className:V.a.calendar__rows,children:e.map(((e,t)=>Object(h.jsx)(J,{cellInd:t,meeting:a,date:e},e)))},e)));return Object(h.jsxs)("article",{className:V.a.calendar,children:[Object(h.jsx)("h2",{children:"Calendar"}),Object(h.jsx)("section",{className:V.a.calendar__container,children:Object(h.jsxs)("div",{className:V.a.calendar__wrapper,children:[Object(h.jsx)("div",{className:V.a.calendar__header,children:t}),Object(h.jsx)("div",{className:V.a.calendar__body,children:s})]})})]})}var W=a(3),$=a.n(W);function X(){const{id:e}=Object(w.h)(),t=Object(w.g)(),{id:a}=Object(l.c)((e=>{let{user:t}=e;return t})),c={name:"",desc:"",from:"",to:"",attendees:""},[s,r]=Object(n.useState)(c),[o,i]=Object(n.useState)({}),d=e=>{const t={...s,[e.target.name]:e.target.value};return r(t),!1};Object(n.useEffect)((()=>{e?fetch("".concat(_.BASE_URL,"meetings/").concat(e)).then((e=>e.json())).then((e=>{var t;const[a,n]=(null===(t=e.dates)||void 0===t?void 0:t.split(","))||{};r({...e,from:a,to:n})})):r(c)}),[e]);return Object(h.jsx)("div",{className:$.a.meeting,children:Object(h.jsxs)("form",{className:$.a.form,children:[Object(h.jsx)("h2",{children:"Schedule Meeting"}),Object(h.jsxs)("div",{className:$.a.row,children:[Object(h.jsx)("input",{className:$.a.input,type:"text",name:"name",value:s.name,placeholder:"Name",onChange:d}),Object(h.jsx)("div",{className:$.a.error,children:null===o||void 0===o?void 0:o.name})]}),Object(h.jsxs)("div",{className:$.a.row,children:[Object(h.jsx)("input",{className:$.a.input,type:"text",name:"desc",value:s.desc,placeholder:"Description",onChange:d}),Object(h.jsx)("div",{className:$.a.error,children:null===o||void 0===o?void 0:o.desc})]}),Object(h.jsxs)("div",{className:$.a.row,children:[Object(h.jsxs)("div",{className:$.a.row__subFields,children:[Object(h.jsx)("input",{className:$.a.input,type:"text",name:"from",value:s.from,placeholder:"From (DD-MM-YYYY)",onChange:d}),Object(h.jsx)("input",{className:$.a.input,type:"text",name:"to",value:s.to,placeholder:"To (DD-MM-YYYY)",onChange:d})]}),Object(h.jsx)("div",{className:$.a.error,children:null===o||void 0===o?void 0:o.dates})]}),Object(h.jsxs)("div",{className:$.a.row,children:[Object(h.jsx)("input",{className:$.a.input,type:"text",name:"attendees",value:s.attendees,placeholder:"Attendees (e.g. test@email.com, test1@email.com)",onChange:d}),Object(h.jsx)("div",{className:$.a.error,children:null===o||void 0===o?void 0:o.attendees})]}),Object(h.jsx)("div",{className:$.a.row,children:Object(h.jsx)("input",{type:"submit",value:"Schedule",className:$.a.button__primary,onClick:n=>{n.preventDefault();const c=M(s);return i(c),Object.keys(c).length?null:fetch("".concat(_.BASE_URL,"meetings").concat(e?"/".concat(e):""),{method:e?"PUT":"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({...s,userId:a,dates:"".concat(s.from,",").concat(s.to)})}).then((e=>e.json())).then((e=>{e.id&&t("/")}))}})})]})})}function Q(){return Object(h.jsxs)(w.d,{children:[Object(h.jsx)(w.b,{path:"/login",element:Object(h.jsx)(G,{})}),Object(h.jsx)(w.b,{path:"/",element:Object(h.jsx)(S,{children:Object(h.jsx)(K,{})})}),Object(h.jsx)(w.b,{path:"/meeting",element:Object(h.jsx)(S,{children:Object(h.jsx)(X,{})})}),Object(h.jsx)(w.b,{path:"/meeting/:id",element:Object(h.jsx)(S,{children:Object(h.jsx)(X,{})})})]})}a(36);function ee(){return Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(E,{children:Object(h.jsx)(Q,{})})})}const te=Object(o.a)(i.a),ae=Object(o.c)(m,void 0,te),ne=document.getElementById("root");s.a.render(Object(h.jsx)(n.StrictMode,{children:Object(h.jsx)(l.a,{store:ae,children:Object(h.jsx)(r.a,{children:Object(h.jsx)(ee,{})})})}),ne)},6:function(e,t,a){e.exports={calendar__highlighted:"Cell_calendar__highlighted__muok5","calendar__cell--highlighted":"Cell_calendar__cell--highlighted__342wq",calendar__cell:"Cell_calendar__cell__3l4Mc","calendar__cell--disabled":"Cell_calendar__cell--disabled__39Z9W",Information:"Cell_Information__3hv-4",Information__container:"Cell_Information__container__29Jwe",Information__label:"Cell_Information__label__33_US"}},7:function(e,t,a){e.exports={login:"Login_login__v-zyX",row:"Login_row__3-vYs",form:"Login_form__2xtVo",input:"Login_input__1ULdo",button__primary:"Login_button__primary__1_3Ze",error:"Login_error__uPzmb"}},9:function(e,t,a){e.exports={calendar:"Calendar_calendar__31zKj",calendar__container:"Calendar_calendar__container__3jIya",calendar__header:"Calendar_calendar__header__1GzDd",calendar__body:"Calendar_calendar__body__38ufW",calendar__rows:"Calendar_calendar__rows__2O4O0",calendar__wrapper:"Calendar_calendar__wrapper__2nSw3",calendar__cell:"Calendar_calendar__cell__1Fnps"}}},[[37,1,2]]]);
//# sourceMappingURL=main.0284d9da.chunk.js.map